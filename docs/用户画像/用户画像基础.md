<div align="center"><img src="https://gitee.com/struggle3014/picBed/raw/master/name_code.png"></div>

# 导读

随着大数据技术的深入研究与应用，企业关注如何利用大数据为精细化运营和精准营销服务，而精细化运营的基础就是用户画像。

***持续更新中~***



# 目录

<nav>
<a href='#导读' style='text-decoration:none;font-weight:bolder'>导读</a><br/>
<a href='#目录' style='text-decoration:none;font-weight:bolder'>目录</a><br/>
<a href='#正文' style='text-decoration:none;font-weight:bolder'>正文</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href='#1 用户画像是什么' style='text-decoration:none;${border-style}'>1 用户画像是什么</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#用户画像简介' style='text-decoration:none;${border-style}'>用户画像简介</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#标签类型' style='text-decoration:none;${border-style}'>标签类型</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href='#2 数据架构' style='text-decoration:none;${border-style}'>2 数据架构</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href='#3 主要覆盖模块' style='text-decoration:none;${border-style}'>3 主要覆盖模块</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href='#4 开发流程阶段' style='text-decoration:none;${border-style}'>4 开发流程阶段</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#4.1 开发上线流程' style='text-decoration:none;${border-style}'>4.1 开发上线流程</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href='#4.2 各阶段关键产出' style='text-decoration:none;${border-style}'>4.2 各阶段关键产出</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href='#5 画像应用落地' style='text-decoration:none;${border-style}'>5 画像应用落地</a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a href='#6 定性类画像' style='text-decoration:none;${border-style}'>6 定性类画像</a><br/>
<a href='#总结' style='text-decoration:none;font-weight:bolder'>总结</a><br/>
<a href='#参考文献' style='text-decoration:none;font-weight:bolder'>参考文献</a><br/>
</nav>

# 正文

## 1 用户画像是什么

### 用户画像简介

**用户画像，即用户信息标签化**，通过收集用户的**社会属性、消费习惯、偏好特征**等**各个维度**的数据，进而对用户或产品特征属性进行刻画，并对这些特征进行分析、统计、挖掘潜在价值信息，从而抽象出用户的信息全貌。

用户画像是企业应用大数据的根基，是定向广告投放与个性化推荐的前置条件，为数据驱动运营奠定了条件。

用户画像可以帮助大数据“走出”数据仓库，针对用户进行个性化推荐、精准营销、个性化服务等多样化服务，是大数据落地应用的一个重要方向。**数据应用体系的层次划分**如下图所示。

![数据应用体系层次划分](https://gitee.com/struggle3014/picBed/raw/master/数据应用体系层次划分.png)

<div align="center"><font size="2">数据应用体系层次划分</font></div>

### 标签类型

用户画像建模其实就是对用户“**打标签**”，对用户打标签的方式有三类：

* **统计类标签**

  该类标签最基础的标签类型。例如，用户的性别、年龄、城市、近7日活跃时长、近7日活跃天数、近7日活跃次数可从用户注册、用户访问、消费数据中统计。该类标签构成了用户画像的基础。

* **规则类标签**

  该类标签**基于用户行为及确定规则**产生。例如，平台上“消费活跃用户”口径定义为“近30天交易次数>=2”。在实际开发中，运营人员对业务数据更熟悉，而数据人员对于数据的结构、分布、特征更为熟悉，因此**规则类标签的规则由运营人员和数据人员共同协商确定**。

* **机器学习挖掘类标签**

  该类标签通过机器学习挖掘产生，**对于用户的某些属性和某些行为进行预测判断**。例如，根据用户的行为习惯判断该用户性别、根据用户的消费习惯判断对某商品的偏好程度。

  在工程实践中，统计类和规则类标签可满足需求且占较大比重。机器学习挖掘类标签多用户预测场景，如判断用户性别、用户购买商品偏好、用户流失意向。机器学习类标签开发周期长、开发成本高等特点，因而开发占比较小。



## 2 数据架构

下图所示是用户画像数仓架构图，主要由流式计算框架、ETL 及产品端三部分组成。

![用户画像数仓架构](https://gitee.com/struggle3014/picBed/raw/master/用户画像数仓架构.png)

<div align="center"><font size="2">用户画像数仓架构</font></div>

下方虚线框是常见数仓 ETL 加工过程，将每日业务数据、日志数据、埋点数据以及外部数据经过 ETL 处理，加工到数仓中。

中间虚线框是用户画像建模的主要环节，用户画像是基于 ODS 层、DW 层、DM 层中与用户相关数据的二次建模加工。在 ETL 过程中将用户标签计算结果写入 Hive，由于存在不同的应用场景，需要将数据进一步同步到 MySQL、HBase、ES 中。

* Hive：存储用户标签计算结果、用户人群计算结果、用户特征库计算结果。
* MySQL：存储标签元数据、监控相关数据
* HBase：存储线上接口实时调用类数据
* ES：支持海量数据的实时查询分析，用于存储用户人群计算、用户透视分析所需的用户标签数据。（由于用户人群计算、用户群透视分析的条件转换成的 SQL 语句多条件嵌套较为复杂）

用户标签数据在 Hive 中加工完成，部分标签通过 Sqoop 同步到 MySQL 数据库，用于 BI 报表展示数据、多维透视分析数据；另一部分标签同步到 HBase 中用于产品线上个性化推荐。



## 3 主要覆盖模块

![用户画像主要覆盖模块](https://gitee.com/struggle3014/picBed/raw/master/用户画像主要覆盖模块.png)

<div align="center"><font size="2">用户画像主要覆盖模块</font></div>

搭建用户画像整体方案需考虑8个模块，即

* 用户画像基础

  * 需明确用户画像是什么

  * 数据架构是什么样子

  * 开发流程

  * 表结构设计
  * 这些都是框架，大方向的规划，只有明确了方向后续才能做好项目的排期和人员投入预算。对于评估每个开发阶段重要指标和关键产出非常重要。

* 数据指标体系

  根据业务线梳理，包括用户属性、用户行为、用户消费、风险控制等维度的指标体系。

* 标签数据存储

  标签相关数据可存储在 Hive、MySQL、HBase、ES 中，不同的存储方式适用于不同的应用场景。

* 标签数据开发

  包括统计类、规则类、挖掘类标签开发，以及人群计算功能的开发，打通画像数据和各业务系统间的通路，提供接口服务。

* 开发性能调优

  标签加工、人群计算脚本上线调度后，为缩短调度时间、保障数据稳定性，需对代码优化。

* 作业流程调度

  标签加工、人群计算、数据同步、数据监控预警等任务需要使用调度工具把整套流程调度起来。

* 用户画像产品化

  为了让用户数据更好地服务于业务方，需要以产品化的形态应用在业务上。**产品化的模块**主要包括标签视图、**用户标签查询、用户分群、透视分析**等。

* 用户画像应用

  画像的应用场景包括用户特征分析、短信、邮件、站内信息、精准推送、客服对用户的话术等。



## 4 开发流程阶段

### 4.1 开发上线流程

用户画像建设流程如图所示，

![用户画像建设流程](https://gitee.com/struggle3014/picBed/raw/master/用户画像建设流程.png)

<div align="center"><font size="2">用户画像建设流程</font></div>

**第一阶段：目标解读**

在建立用户画像前，首先需要根据用户画像服务于企业的对象，再根据业务方需求，明确未来产品建设目标和用户画像分析之后的预期效果。

一般而言，用户画像的服务对象包括运营人员和数据分析人员。不同业务方对用户画像的需求有不同的侧重点。**运营人员**需要分析用户的特征、定位用户行为偏好、做好商品或内容的个性化推送以提高点击转化率，所以画像的侧重点就落在用户个人行为偏好上。**数据分析人员**需分析用户行为特征，做好用户流式预警工作，还可以根据用户的消费偏好做更有针对性的营销策略。

**第二阶段：任务分解与需求调研**

第一阶段已明确用户画像的服务对象与应用场景，接下来需针对服务对象的需求侧重点，结合产品现有体系和“数据字典”规约实体和标签间的关联关系，明确分析维度。就后续的案例而言，需从用户属性画像、用户行为画像、用户偏好画像、用户群体偏好画像等角度进行业务建模。

**第三阶段：需求场景讨论与明确**

在该阶段，数据运营人员需根据与需求方的沟通结果，输出产品用户画像需求文档，在该文档中明确画像应用场景、最终开发出的标签内容与应用方式，并就该文档与需求反复沟通并确认无误。

**第四阶段：应用场景与数据口径确认**

经过第三个阶段明确了需求场景与最终实现的标签维度、标签类型后，数据运营人员需结合业务与数据仓库中已有的相关表，明确与各业务场景相关的数据口径。在该阶段中，数据运营方面需要输出产品用户画像开发文档，该文档需要明确应用场景、标签开发模型、涉及的数据库与表 以及应用流程实施。该文档不需要再与运营方讨论，只需要面向数据运营团队内部就开发实施流程达成一致意见即可。

**第五阶段：特征选择与模型数据落表**

本阶段中数据挖掘人员需根据前面明确的需求场景进行业务建模，写好 HQL 逻辑，将相应的模型逻辑写入临时表，并抽取数据校验是否符合业务场景需求。

**第六阶段：线下模型数据验收与测试**

数仓团队的人员将相关数据落表后，设定定时任务，定时增量更新数据。数据运营人员需验收数仓加工的逻辑是否符合需求，根据业务需求抽取表中数据查看其是否在合理范围内，如果发现问题要及时反馈给数仓人员调整代码逻辑和行为权重的数值。

**第七阶段：线上模型发布与效果追踪**

经过第六节段，数据通过验收之后，会通过 Git 进行版本管理、部署上线。使用 Git 进行版本管理，上线后通过持续追踪标签应用效果及业务方反馈，调整优化模型及相关权重配置。



### 4.2 各阶段关键产出

为保证程序上线的准时性和稳定性，需规划好各阶段的任务排期和关键产出。画像体系的开发分为几个主要阶段：

* 前期指标体系梳理
* 用户标签开发
* ETL 调度开发
* 打通数据服务层
* 画像产品端开发
* 面向业务方推广应用
* 为业务方提供营销策略的解决方案

![用户画像项目各阶段产出](https://gitee.com/struggle3014/picBed/raw/master/用户画像项目各阶段产出.png)



## 5 画像应用落地

用户画像最终的价值是要落地运行，为业务带来实际价值。整个过程需要**多方协调**。

开发标签的**数据工程师**和**需求方**相互协助，将标签应用到业务中；**开发人员**组织数据分析、运营、客服等团队的人员进行画像应用上的推广；**数据分析人员**会关注用户画像开发了表、字段及字段的口径定义；**运营、客服**更关注用户标签定义的口径，如何在 Web 端使用用户画像产品进行分析、圈定用户进行定向营销，以及应用业务上数据的准确性和及时性。



## 6 定性类画像

相对于定量刻画用户画像，定性刻画也是常见手段。定性类画像多见于用户研究等运营类岗位，通过电话调研、网络问卷或当面访谈等方式收集用户数据，帮助更好理解用户。

相较于大数据定量刻画用户而言，可以更加精准地了解用户需求和行为特征，但样本数有限，得出的结论不具代表性。



# 总结

本文介绍用户画像的基础知识，包括画像简介、标签类型、画像系统的数据架构、开发画像系统的8个模块以及各阶段的关键产出。初步介绍画像系统的轮廓，对于如何设计画像系统、开发周期、画像的应用等有了宏观的初步的认识。



# 参考文献

[1] [用户画像：方法论与工程化解决方案](https://www.99baiduyun.com/baidu/用户画像：方法论与工程化解决方案)